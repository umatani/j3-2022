<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<html> <head>
<META name="robots" content="noindex,nofellow">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=UTF-8">
<title>$B%W%m%0%i%_%s%01i=,(B Turtle.java</title>
<link href="https://fonts.googleapis.com/css?family=Lato:400,700|Noto+Sans+JP:400,700" rel="stylesheet">
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet">
<LINK rel="stylesheet" href="../oop-new.css" type="text/css">

<script type="text/javascript" src="js/shCore.js"></script>
<script type="text/javascript" src="js/shBrushJava.js"></script>
<script type="text/javascript" src="js/shBrushCpp.js"></script>
<link href="css/shCore.css" rel="stylesheet" type="text/css" />
<link href="css/shCoreDefault2.css" rel="stylesheet" type="text/css" />
<link href="css/shThemeDefault2.css" rel="stylesheet" type="text/css" />
<script type="text/javascript">
     SyntaxHighlighter.all()
</script>
</head>

<body>
<h1><tt>Turtle.java</tt></h1>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>

<pre class="brush: java">
//
// Turtle Graphics Library extension for teaching OO concepts
// by Hideki Tsuiki, Kyoto University
// as a modification of Tatsuya Hagino's Turtle Graphics Library
// Copyright (C) 2000, Hideki Tsuiki, Kyoto University

// Turtle Graphics Library for Information Processing I
// Copyright (C) 1998, Tatsuya Hagino, Keio University
//
// Permission to use, copy, modify, and distribute this software
// for educational purpose only is hereby granted, provided that
// the above copyright notice appear in all copies and that both
// the copyright notice and this permission notice appear in
// supporting documentation.  This software is provided "as is"
// with no warranty.


import java.awt.*;
import java.awt.event.*;
import java.io.*;
import java.lang.Math;
import java.util.Vector;

/** ã‚¿ãƒ¼ãƒˆãƒ«ã®ã‚¯ãƒ©ã‚¹ã€‚ */
public class Turtle implements Cloneable{
   /** ã‚‚ã—ã€false ãªã‚‰ã€å€‹ã€…ã®ã‚¿ãƒ¼ãƒˆãƒ«ã®
   * withTurtle ã®å€¤ã«é–¢ã‚ã‚‰ãšã€å…¨ã¦ã®ã‚¿ãƒ¼ãƒˆãƒ«ã«é«˜é€Ÿãªæç”»ã‚’è¡Œã†ã€‚
   * åˆæœŸå€¤ã¯ trueã€‚*/
   public static boolean withTurtleAll = true;
   public Color tcolor = Color.green;
   public double tscale = 0.4;

   // animation parameters
   private static double rotateStep = 5.0 *Math.PI/180.0 ;
   private static int moveStep = 5;
   private static int[] speedStep = {100000, 20, 5, 2};

   // turtle animation speed constants
   public final static int speedNoTurtle = 0;
   public final static int speedFast = 1;
   public final static int speedNormal = 2;
   public final static int speedSlow = 3;

   // set the menu
   public static void speedAll(int s) {
      if (s <= 0 || s >= speedStep.length) return;
      rotateStep = speedStep[s] *Math.PI/180.0;
      moveStep = speedStep[s];
   }

   private TurtleFrame f;  // on this TurtleFrame 
   private double angle;		// turtle current angle 
   private double x, y;		// turtle current position
   private double dx, dy;	// dx = sin(angle),  dy = -cos(angle)
   private boolean penDown;	// pen status (up or down)
   private Color c = Color.black; // pen color
   private int turtleType = 0;
   // turtle animation rubber line
   private int rx, ry;
   private boolean rubber = false;
   private int moveWait = 20;
   private int rotateWait = 20;

   /**  (x, y) ã¨ã„ã†åº§æ¨™ã« angle ã®è§’åº¦ã§ã€Turtle ã‚’ä½œæˆã€‚ */
   public Turtle(int x,int y, int ia)
      {
	 this.x = ((double)x + 0.5);
	 this.y = ((double)y + 0.5);
	 setangle((double)ia *Math.PI/180.0);
	 penDown = true;
      }

   /** (200,200) ã¨ã„ã†åº§æ¨™ã« 0 åº¦ã®è§’åº¦ã§ã€Turtle ã‚’ä½œæˆã€‚ */
   public Turtle()
      {
	 this(200,200, 0);
      }

   // turtle
   public static final int turtleFig[][] =
   { {-12,-6,-12,6,0,18,12,6,12,-6,0,-18,-12,-6},
     {-18,-12,-12,-6},
     {-6,-24,0,-18,6,-24},
     {12,-6,18,-12},
     {12,6,18,12},
     {-6,24,0,18,6,24},
     {-18,12,-12,6},
     {-18,12,-18,-12,-6,-24,6,-24,18,-12,18,12,6,24,-6,24,-18,12},
     {-15,-15,-18,-24,-9,-21},
     {9,-21,18,-24,15,-15},
     {15,15,18,24,9,21},
     {-9,21,-18,24,-15,15},
     {-3,24,0,30,3,24},
     {-6,-24,-12,-36,-6,-48,6,-48,12,-36,6,-24}
   };
   public static final int turtleRFig[][] =
   { {-12,-6,-12,6,0,18,12,6,12,-6,0,-18,-12,-6},
     {-18,-12,-12,-6},
     {-6,-24,0,-18,6,-24},
     {12,-6,18,-12},
     {12,6,18,12},
     {-6,24,0,18,6,24},
     {-18,12,-12,6},
     {-18,12,-18,-12,-6,-24,6,-24,18,-12,18,12,6,24,-6,24,-18,12},
     {-15,-15,-24,-18,-9,-21},
     {-9,21,-24,18,-15,15},
     {-3,24,-3,30,3,24},
     {-6,-24,-6,-36,0,-48,12,-48,18,-36,6,-24},
     {9,-21,18,-30,15,-15},
     {15,15,18,30,9,21}
   };
   public static final int turtleLFig[][] =
   { {-12,-6,-12,6,0,18,12,6,12,-6,0,-18,-12,-6},
     {-18,-12,-12,-6},
     {-6,-24,0,-18,6,-24},
     {12,-6,18,-12},
     {12,6,18,12},
     {-6,24,0,18,6,24},
     {-18,12,-12,6},
     {-18,12,-18,-12,-6,-24,6,-24,18,-12,18,12,6,24,-6,24,-18,12},
     {-15,-15,-18,-30,-9,-21},
     {-9,21,-18,30,-15,15},
     {-3,24,3,30,3,24},
     {-6,-24,-18,-36,-12,-48,0,-48,6,-36,6,-24},
     {9,-21,24,-18,15,-15},
     {15,15,24,18,9,21}
   };
   protected int[][] turtleC = turtleFig;
   protected int[][] turtleR = turtleRFig;
   protected int[][] turtleL = turtleLFig;

   // draw animation turtle
   private void turtleDraw(Graphics g, int[][] data) {
      int ix = (int)x, iy = (int)y;
      g.setColor(tcolor);
      for (int i = 0; i < data.length; i++) {
	 int px = 0, py = 0;
	 for (int j = 0; j < data[i].length; j += 2) {
	    int kx = data[i][j], ky = data[i][j+1];
	    int nx = (int)((kx*(-dy) + ky*(-dx)) * tscale);
	    int ny = (int)((kx*dx+ ky*(-dy)) * tscale);
	    if (j > 0) g.drawLine(ix + px, iy + py, ix + nx, iy + ny);
	    px = nx;
	    py = ny;
	 }
      }
      g.setColor(c);
      g.fillOval(ix - 1, iy - 1, 2,2);
   }

   void setFrame(TurtleFrame f){
      this.f = f;
   }

   void show(Graphics g){
      if (rubber) {
	 g.setColor(c);
	 g.drawLine(rx, ry, (int)x, (int)y);
      }
      if (withTurtleAll) {
	 switch ((turtleType/2) % 4) {
	 case 0: case 2: 
	    turtleDraw(g, turtleC);
	    break;
	 case 1:
	    turtleDraw(g, turtleR);
	    break;
	 case 3:
	    turtleDraw(g, turtleL);
	    break;
	 }
      }
   }

   private void fcheck(){
      if(f == null) {
	 System.out.println("Turtle ã«å¯¾ã—ã¦ fd ãªã©ã‚’å‘¼ã³å‡ºã™ã¾ãˆã«ï¼ŒTurtleFrame ã« add ã—ã¦ãã ã•ã„ã€‚");
	 System.exit(1);
      }
   }

   // turtle animation update
   private void turtleShow(int wait) {
      turtleType++;
      f.repaint();
      if (withTurtleAll) {
	 try {
	    Thread.sleep(wait);
	 } catch (InterruptedException e) {
	 }
      }
   }

   /** n ã ã‘å‰ã«é€²ã‚€ã€‚ */
   public void fd(int n) {
      dfd(n);
   }

   public void dfd(double n) {
      double xx = x;
      double yy = y;
      int back = 1;
      if(n < 0){
	 back = -1; n = -n;
      }
      fcheck();
      if (penDown) {
	 rx = (int)x;
	 ry = (int)y;
	 rubber = true;
      }
      for (int i = moveStep; i < n; i += moveStep) {
	 x = xx + back * dx * i;
	 y = yy + back * dy * i;
	 turtleShow(moveWait);
      }
      x = xx + back * dx * n;
      y = yy + back * dy * n;
      if (penDown) {
	 f.addLineElement((int)xx, (int)yy, (int)x, (int)y, c);
	 rubber = false;
      }
      turtleShow(moveWait);
   }

   /** n ã ã‘å¾Œã‚ã«é€²ã‚€ã€‚ */
   public void bk(int n) {
      fd(-n);
   }

   private void setangle(double a)
      {
	 angle = a;
	 dx = Math.sin(a);
	 dy = -Math.cos(a);
      }

   // set turtle angle
   private void turtleAngle(double a) {
      dx = Math.sin(a);
      dy = -Math.cos(a);
      turtleShow(rotateWait);
   }

   /** n åº¦ã ã‘å³ã«å›ã‚‹ã€‚ */
   public void rt(int ia) {
      rtd((double)ia*Math.PI/180.0);
   }
  
   private void rtd(double a)  {
      fcheck();
      for (double i = rotateStep; i < a; i += rotateStep)
	 turtleAngle(angle + i);
      angle = (angle + a);
      turtleAngle(angle);
   }

   /** n åº¦ã ã‘å·¦ã«å›ã‚‹ã€‚ */
   public void lt(int ia) {
      ltd((double)ia*Math.PI/180.0);
   }
  
   public void ltd(double a)  {
      fcheck();
      for (double i = rotateStep; i < a; i += rotateStep)
	 turtleAngle(angle - i);
      angle = (angle - a);
      turtleAngle(angle);
   }

   /** ãƒšãƒ³ã‚’ã‚ã’ã‚‹ã€‚  */
   public void up() {
      penDown = false;
   }

   /** ãƒšãƒ³ã‚’ãŠã‚ã™ã€‚ãƒšãƒ³ã‚’ãŠã‚ã—ãŸçŠ¶æ…‹ã§é€²ã‚€ã¨ã€ãã®è»Œè·¡ãŒç”»é¢ã«æ®‹ã‚‹ã€‚*/
   public void down() {
      penDown = true;
   }

   /** ãƒšãƒ³ãŒä¸ŠãŒã£ã¦ã„ã‚‹ã‹ã©ã†ã‹ */
   public boolean isDown() {
      return (penDown);
   }

   /**  ãƒšãƒ³ã®è‰²ã‚’ nc ã«å¤‰æ›´ã™ã‚‹ã€‚ */
   public void setColor(Color nc) {
      c = nc;
   }

   /** å‹•ãã®æ—©ã•ã‚’ x ã«è¨­å®šã™ã‚‹ã€‚x = 20 ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã‚ã‚‹ã€‚æ•°å­—ãŒå°ã•ã„ã»ã©æ—©ã„ã€‚*/
   public void speed(int x)
      {
	 moveWait = x;
	 rotateWait = x;
      }
  
   /** ç¾åœ¨ã®åº§æ¨™ã® X æˆåˆ†ã‚’è¿”ã™ã€‚ */
   public int getX()
      {
	 return (int)this.x;
      }

   /** ç¾åœ¨ã®åº§æ¨™ã® Y æˆåˆ†ã‚’è¿”ã™ã€‚*/
   public int getY()
      {
	 return (int)this.y;
      }

   /** ç¾åœ¨ã®è§’åº¦ã‚’è¿”ã™ã€‚*/
   public int getAngle()
      {
	 return (int)(this.angle * 180.0 /Math.PI);
      }

   public int moveTo(double x, double y) { 
      double prevx = this.x; double prevy = this.y;
      //    double a = Math.atan2(-( y - prevy), x - prevx);
      double a = Math.atan2(x - prevx, -( y - prevy));
      setangle(a);
      int r = (int)Math.sqrt((prevx - x) * (prevx - x) + (prevy - y) * (prevy - y));
      fd(r);
      this.x = ((double)x + 0.5);
      this.y = ((double)y + 0.5);
      turtleShow(moveWait);    
      return(r);
   }

   public int moveTo(double x, double y, double aa) { 
      int r = moveTo(x, y);
      setangle(aa);
      turtleShow(moveWait);    
      return(r);
   }

   /** moveTo(x, y) ã¨åŒæ§˜ã ãŒï¼Œãã®å¾Œã«ï¼Œangle ã®æ–¹å‘ã‚’å‘ãã€‚
    * ç§»å‹•ã—ãŸè·é›¢ã‚’è¿”ã™ã€‚
    */
   public int moveTo(int x, int y, int angle){
      return moveTo((double)x, (double)y, (double)angle*Math.PI/180.0);
   }
   
   /** (x, y) ã¨ã„ã†åº§æ¨™ã¾ã§ç§»å‹•ã™ã‚‹ã€‚ãƒšãƒ³ã‚’ãŠã‚ã—ãŸçŠ¶æ…‹ãªã‚‰ã€ç·šãŒæç”»ã•ã‚Œã‚‹ã€‚
    * ç§»å‹•ã—ãŸè·é›¢ã‚’è¿”ã™ã€‚
    */
   public int moveTo(int x, int y){
      return moveTo((double)x, (double)y);
   }

   /** t ã¨åŒã˜åº§æ¨™ã¾ã§ç§»å‹•ã™ã‚‹ã€‚ãƒšãƒ³ã‚’ãŠã‚ã—ãŸçŠ¶æ…‹ãªã‚‰ã€ç·šãŒæç”»ã•ã‚Œã‚‹ã€‚
    *   ç§»å‹•ã—ãŸè·é›¢ã‚’è¿”ã™ã€‚
    */
   public int moveTo(Turtle t)
      {
	 return moveTo(t.x, t.y);
      }

   /** è‡ªåˆ†ã¨åŒã˜çŠ¶æ…‹ã® Turtle ã‚’ä½œæˆã—ï¼Œè¿”ã™ã€‚
    */
   public Turtle clone()
      {
	 try{
	    return (Turtle)super.clone();
	 }catch(CloneNotSupportedException e){}
	 return null;
      }
}
</div>
</body>
</html>
